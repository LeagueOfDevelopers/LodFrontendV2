<div class="profile-settings__wrap">
  <h1 class="profile-settings__heading headline">Редактирование профиля</h1>

  <div class="dividing-line"></div>

  <form name="profileSettingsForm">

    <div class="profile-settings__top-part">

      <div class="profile-settings__avatar-wrapper">
        <div class="profile-settings__avatar-img"
             ng-attr-style="background-image: url({{profile.Image.BigPhotoUri || DEFAULT_DEVELOPER_PHOTO}})"
             dropzone-big-image>

          <div class="adding-project__file-close adding-project__big-image__file-close"
               ng-if="profile.Image.BigPhotoUri"
               ng-click="deleteBigPhoto()"></div>

          <div class="adding-project__uploading__bar-wrap">
            <div class="adding-project__uploading__bar" ng-if="currentUploadStateBigPhoto=='uploading'"
                 ng-attr-style='width: {{currentPercentBigPhoto}}%'></div>
          </div>

        </div>

        <div class="profile-settings__button" upload-big-image>Загрузить фото</div>
      </div>
      <div class="profile-settings__top-part__inputs">

          <div class="profile-settings__input-heading">Институт:</div>
          <select class="profile-settings__input" ng-model="profile.InstituteName" required>
              <option value="ИТАСУ" ng-selected="profile.InstituteName=='ИТАСУ'">ИТАСУ</option>
              <option value="ЭкоТех" ng-selected="profile.InstituteName=='ЭкоТех'">ЭкоТех</option>
              <option value="ИНМиН" ng-selected="profile.InstituteName=='ИНМиН'">ИНМиН</option>
              <option value="ЭУПП" ng-selected="profile.InstituteName=='ЭУПП'">ЭУПП</option>
              <option value="ИБС" ng-selected="profile.InstituteName=='ИБС'">ИБС</option>
              <option value="ИБО" ng-selected="profile.InstituteName=='ИБО'">ИБО</option>
              <option value="Горный" ng-selected="profile.InstituteName=='Горный'">Горный</option>
          </select>

          <div class="profile-settings__input-heading">Кафедра:</div>
          <input type="text" class="profile-settings__input validate-field" ng-model="profile.StudyingDirection"
                 pattern="^[а-яА-ЯёЁ- _\.]{1,255}$" required />

          <div class="profile-settings__input-heading">Специальность:</div>
          <input type="text" class="profile-settings__input validate-field" ng-model="profile.Specialization"
                 pattern="[а-яА-ЯёЁ- _\.]{1,255}$" required />

          <div class="profile-settings__input-heading">Год поступления:</div>
          <input type="number" class="profile-settings__input validate-field"
                 min="2000" max="{{currentDate | date:'yyyy'}}" ng-model="profile.StudentAccessionYear"
                 pattern="[1-9]\d*" ng-minlength="4" ng-maxlength="4" required />

          <div class="help-message-input profile-settings__help-message"
               ng-show="profileSettingsForm.studentAccessionYear.$error.pattern">
              Вы не могли поступать в этот год.
          </div>
          <div class="profile-settings__input-heading">Я студент:</div>
          <div class="profile-settings__switcher profile-settings__input">
              <input type="radio" id="isNotGraduated" ng-model="profile.IsGraduated" ng-value="false" class="profile-settings__switcher_input">
              <label for="isNotGraduated" class="profile-settings__switcher_label">Да</label>
              <input type="radio" id="isGraduated" ng-model="profile.IsGraduated" ng-value="true" class="profile-settings__switcher_input">
              <label for="isGraduated" class="profile-settings__switcher_label">Нет</label>
          </div>

          <div class="profile-settings__input-heading">Номер телефона:</div>
          <input type="text" class="profile-settings__input validate-field" ng-model="profile.PhoneNumber"
                 ui-mask="+7-(999)-999-99-99" ui-mask-placeholder-char=" " required />

          <div class="profile-settings__input-heading">Профиль ВКонтакте:</div>
          <input type="url" name="vkUrl" class="profile-settings__input validate-field" pattern="^(http|https)?://vk.com/.+$"
                 ng-model="profile.VkProfileUri" ng-maxlength="100" />

          <div class="help-message-input profile-settings__help-message__vk-uri"
               ng-show="profileSettingsForm.vkUri.$error.url">
              Введите адрес в формате
              http(s)://vk.com/[username].
          </div>

          <div class="profile-settings__input-heading">Профиль на GitHub:</div>

          <input type="url" class="profile-settings__input" ng-disabled="true"
                 ng-show="profile.LinkToGithubProfile!==null&&
                          profile.LinkToGithubProfile!==undefined"
                 ng-model="profile.LinkToGithubProfile">

          <div class="profile-settings__button"
               ng-click="getRedirectionToAuthenticationGithubForm()"
               ng-disabled="isDisabled"
               ng-show="profile.LinkToGithubProfile===null||
                      profile.LinkToGithubProfile===undefined">Привязать профиль</div>
      </div>
    </div>

    
    <h1 ng-if="profile.HasPassword===true" class="profile-settings__heading headline">Изменение пароля</h1>

    <div ng-if="profile.HasPassword===true" class="dividing-line"></div>
    <div ng-if="profile.HasPassword===true" class="profile-settings__middle-part__wrapper">
      <div class="profile-settings__middle-part">
        <div class="profile-settings__input-heading">Новый пароль:</div>
        <input type="password" name="newPassword" class="profile-settings__input" ng-model="newPassword"
               ng-class="{'validate-field': newPassword||newPassword==undefined}"
               pattern="^(?=^.{8,50}$)[a-zA-Z0-9]+$"
               ng-minlength="8" ng-maxlength="50"
               ng-required="profileSettingsForm.newPassword.$error.pattern||newPassword||repeatedPassword"/>
        <br/>

        <div class="help-message-input profile-settings__help-message__password"
             ng-show="profileSettingsForm.newPassword.$error.pattern">Пароль должен быть длинной не
                                                                      менее 8 символов и не более 50, а также содержать
                                                                      только цифры или латинские буквы.
        </div>

        <div class="profile-settings__input-heading">Повторите пароль:</div>
        <input type="password" name="repeatedPassword" class="profile-settings__input" ng-model="repeatedPassword"
               ng-class="{'validate-field': repeatedPassword||repeatedPassword==undefined}"
               pattern="^(?=^.{8,50}$)[a-zA-Z0-9]+$"
               ng-minlength="8" ng-maxlength="50"
               ng-required="profileSettingsForm.repeatedPassword.$error.pattern||newPassword||repeatedPassword"/>
        <br/>

        <div class="help-message-input" ng-show="repeatedPassword!=newPassword && newPassword && repeatedPassword">Пароли не
                                                                                                               совпадают.
        </div>

      </div>

      <div class="profile-settings__support-div"></div>

    </div>

    <h1 class="profile-settings__heading headline">Настройка оповещений</h1>

    <div class="dividing-line"></div>

    <div class="profile-settings__bottom-part" ng-switch="notification">

      <div class="profile-settings__bottom-part__heading">Посылать на почту оповещения:</div>

      <label class="profile-settings__checkbox-label">
        <span ng-click="toggleNotifications(4)"
              ng-class="{'profile-settings__notification--activated': notifications[4]}"
              class="profile-settings__notification"></span>
        <span class="profile-settings__notification__text">О появлении новых проектов</span>
      </label>
      <br/>

      <label class="profile-settings__checkbox-label">
        <span ng-click="toggleNotifications(1)"
              ng-class="{'profile-settings__notification--activated': notifications[1]}"
              class="profile-settings__notification"></span>
        <span class="profile-settings__notification__text">О новом разработчике на проекте</span>
      </label>
      <br/>

      <label class="profile-settings__checkbox-label">
        <span ng-click="toggleNotifications(0)"
              ng-class="{'profile-settings__notification--activated': notifications[0]}"
              class="profile-settings__notification"></span>
        <span class="profile-settings__notification__text">Об уходе разработчика с проекта</span>
      </label>
      <br/>

      <label class="profile-settings__checkbox-label">
        <span ng-click="toggleNotifications(3)"
              ng-class="{'profile-settings__notification--activated': notifications[3]}"
              class="profile-settings__notification"></span>
        <span
          class="profile-settings__notification__text">О полностью подтвержденной регистрации нового разработчика</span>
      </label>
      <br/>

      <label class="profile-settings__checkbox-label">
        <span ng-click="toggleNotifications(2)"
              ng-class="{'profile-settings__notification--activated': notifications[2]}"
              class="profile-settings__notification"></span>
        <span class="profile-settings__notification__text">Об успешном подтверждении почты нового разработчика</span>
      </label>
      <br/>

    </div>


    <div class="profile-settings__submit-wrapper">
      <div ng-switch="currentState">
        <p class="help-message-input" ng-switch-when="success">
          Изменения успешно сохранены.
        </p>

        <p class="help-message-input" ng-switch-when="failed">
          Ошибка!
        </p>
      </div>

      <button class="profile-settings__submit" ng-disabled="profileSettingsForm.$invalid||(newPassword!=repeatedPassword)||isDisabled"
              ng-click="changeProfileSettings()">
        Сохранить
      </button>
    </div>

  </form>
</div>